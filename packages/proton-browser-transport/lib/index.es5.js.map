{"version":3,"file":"index.es5.js","sources":["../src/styles.ts","../src/index.ts"],"sourcesContent":["export default `\n/* Anchor Link */\n\n.%prefix% * {\n    box-sizing: border-box;\n    line-height: 1;\n}\n\n.%prefix% {\n    font-family: CircularStd, -apple-system, system-ui, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue',\n        Arial, sans-serif;\n    font-size: 13px;\n    background: rgba(0, 0, 0, 0.65);\n    position: fixed;\n    top: 0px;\n    left: 0px;\n    width: 100%;\n    height: 100%;\n    z-index: 2147483647;\n    display: none;\n    align-items: center;\n    justify-content: center;\n}\n\n.%prefix%-active {\n    display: flex;\n}\n\n.%prefix%-inner {\n    background: rgb(117, 46, 235);\n    color: white;\n    margin: 20px;\n    border-radius: 20px;\n    box-shadow: 0px 4px 100px rgba(0, 0, 0, .5);\n    width: 360px;\n    transition-property: all;\n    transition-duration: .5s;\n    transition-timing-function: ease-in-out;\n    position: relative;\n}\n\n.%prefix%-nav {\n    height: 55px;\n    display: flex;\n    border-radius: 20px 20px 0px 0px;\n    justify-content: space-between;\n    align-items: center;\n    padding: 0px 16px;\n    background-color: rgba(0,0,0,0.2);\n}\n\n.%prefix%-back {\n    background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg%3E%3Cg%3E%3Cpath d='M0 0L24 0 24 24 0 24z' transform='translate(-348 -152) translate(348 152)'/%3E%3Cpath fill='rgba(255,255,255, 0.8)' fill-rule='nonzero' d='M16.41 5.791L14.619 4 7 11.619 14.619 19.239 16.41 17.448 10.594 11.619z' transform='translate(-348 -152) translate(348 152)'/%3E%3C/g%3E%3C/g%3E%3C/g%3E%3C/svg%3E%0A\");\n    background-size: 22px;\n    background-repeat: no-repeat;\n    background-position: 50%;\n    cursor: pointer;\n    width: 16px;\n    height: 16px;\n}\n\n.%prefix%-back:hover {\n    background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg%3E%3Cg%3E%3Cpath d='M0 0L24 0 24 24 0 24z' transform='translate(-348 -152) translate(348 152)'/%3E%3Cpath fill='rgba(255,255,255,1)' fill-rule='nonzero' d='M16.41 5.791L14.619 4 7 11.619 14.619 19.239 16.41 17.448 10.594 11.619z' transform='translate(-348 -152) translate(348 152)'/%3E%3C/g%3E%3C/g%3E%3C/g%3E%3C/svg%3E%0A\");\n}\n\n.%prefix%-close {\n    width: 16px;\n    height: 16px;\n    background-image: url(\"data:image/svg+xml,%3Csvg width='12' height='12' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M9.66 10.987L6 7.327l-3.66 3.66A1.035 1.035 0 11.876 9.523l3.66-3.66-3.66-3.66A1.035 1.035 0 012.34.737L6 4.398 9.66.739a1.035 1.035 0 111.464 1.464l-3.66 3.66 3.66 3.661a1.035 1.035 0 11-1.464 1.464z' fill='rgba(255,255,255, 0.8)' fill-rule='nonzero'/%3E%3C/svg%3E\");\n    background-size: 14px;\n    background-repeat: no-repeat;\n    background-position: 50%;\n    border-radius: 100%;\n    cursor: pointer;\n}\n\n.%prefix%-close:hover {\n    background-image: url(\"data:image/svg+xml,%3Csvg width='12' height='12' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M9.66 10.987L6 7.327l-3.66 3.66A1.035 1.035 0 11.876 9.523l3.66-3.66-3.66-3.66A1.035 1.035 0 012.34.737L6 4.398 9.66.739a1.035 1.035 0 111.464 1.464l-3.66 3.66 3.66 3.661a1.035 1.035 0 11-1.464 1.464z' fill='rgba(255,255,255,1)' fill-rule='nonzero'/%3E%3C/svg%3E\");\n}\n\n.%prefix%-logo {\n    width: 100%;\n    height: 50px;\n    background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='160' height='49' viewBox='0 0 160 49'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23FFF'%3E%3Cg%3E%3Cpath fill-rule='nonzero' d='M58.895 32.064V27.53h3.547c1.361 0 2.547-.224 3.557-.673 1.01-.449 1.785-1.096 2.323-1.942.539-.845.808-1.836.808-2.974 0-1.152-.269-2.147-.808-2.985-.538-.838-1.313-1.481-2.323-1.93-1.01-.449-2.196-.673-3.557-.673h-6.464v15.711h2.917zm3.412-7.003h-3.412v-6.24h3.412c1.272 0 2.237.27 2.895.809.659.538.988 1.309.988 2.311 0 1.003-.33 1.774-.988 2.312-.658.539-1.623.808-2.895.808zm13.942 7.003v-4.579h3.633c.226-.001.4-.009.519-.022l3.21 4.601h3.142l-3.614-5.162c1.077-.42 1.904-1.055 2.48-1.908.576-.853.864-1.87.864-3.053 0-1.152-.269-2.147-.808-2.985-.538-.838-1.313-1.481-2.323-1.93-1.01-.449-2.195-.673-3.557-.673H73.33v15.711h2.918zm3.411-6.98H76.25v-6.262h3.411c1.272 0 2.237.269 2.896.808.658.538.987 1.309.987 2.311 0 1.003-.329 1.777-.987 2.324-.659.546-1.624.819-2.896.819zm18.7 7.205c1.601 0 3.045-.348 4.332-1.044 1.287-.696 2.297-1.657 3.03-2.884.733-1.227 1.1-2.611 1.1-4.153 0-1.54-.367-2.925-1.1-4.152-.733-1.227-1.743-2.188-3.03-2.884-1.287-.696-2.73-1.044-4.332-1.044-1.601 0-3.045.348-4.332 1.044-1.287.696-2.297 1.66-3.03 2.895-.733 1.235-1.1 2.615-1.1 4.141 0 1.527.367 2.907 1.1 4.141.733 1.235 1.743 2.2 3.03 2.896 1.287.696 2.73 1.044 4.332 1.044zm0-2.56c-1.047 0-1.99-.235-2.828-.706-.838-.471-1.496-1.13-1.975-1.975-.479-.846-.718-1.792-.718-2.84 0-1.047.239-1.993.718-2.839.479-.845 1.137-1.504 1.975-1.975.838-.471 1.78-.707 2.828-.707 1.047 0 1.99.236 2.828.707.838.471 1.496 1.13 1.975 1.975.479.846.718 1.792.718 2.84 0 1.047-.239 1.993-.718 2.839-.479.845-1.137 1.504-1.975 1.975-.838.471-1.78.707-2.828.707zm18.722 2.335V18.822h5.207v-2.47h-13.332v2.47h5.207v13.242h2.918zm15.805.225c1.6 0 3.045-.348 4.332-1.044 1.286-.696 2.296-1.657 3.03-2.884.733-1.227 1.1-2.611 1.1-4.153 0-1.54-.367-2.925-1.1-4.152-.734-1.227-1.744-2.188-3.03-2.884-1.287-.696-2.731-1.044-4.332-1.044s-3.045.348-4.332 1.044c-1.287.696-2.297 1.66-3.03 2.895-.733 1.235-1.1 2.615-1.1 4.141 0 1.527.367 2.907 1.1 4.141.733 1.235 1.743 2.2 3.03 2.896 1.287.696 2.73 1.044 4.332 1.044zm0-2.56c-1.048 0-1.99-.235-2.828-.706-.838-.471-1.497-1.13-1.976-1.975-.478-.846-.718-1.792-.718-2.84 0-1.047.24-1.993.718-2.839.48-.845 1.138-1.504 1.976-1.975.838-.471 1.78-.707 2.828-.707 1.047 0 1.99.236 2.828.707.838.471 1.496 1.13 1.975 1.975.479.846.718 1.792.718 2.84 0 1.047-.24 1.993-.718 2.839-.479.845-1.137 1.504-1.975 1.975-.838.471-1.78.707-2.828.707zm15.737 2.335V21.425l8.663 10.64h2.402V16.352h-2.895v10.639l-8.664-10.64h-2.402v15.712h2.896z' transform='translate(-432 -207) translate(432 207)'/%3E%3Cg%3E%3Cpath d='M21.582 0c3.104 0 5.782 3.222 7.545 8.459-.712.198-1.44.42-2.174.666-1.465-4.331-3.476-6.88-5.37-6.88-2.136 0-4.415 3.232-5.899 8.606.58.187 1.165.386 1.762.606 1.346.495 2.735 1.078 4.15 1.74.081-.038.162-.078.243-.115.907-.417 1.808-.801 2.7-1.154l.32-.125c2.671-1.033 5.252-1.773 7.616-2.165 5.088-.846 8.666.03 10.07 2.466 1.409 2.437.38 5.974-2.898 9.956-.189.228-.38.459-.583.686-.488-.542-1.007-1.083-1.561-1.625 2.891-3.354 4.03-6.285 3.1-7.895-.879-1.523-3.777-2.036-7.76-1.375-.85.142-1.735.333-2.643.57.13.596.25 1.205.357 1.835.246 1.41.436 2.903.57 4.458.7.492 1.384.991 2.04 1.5 2.572 1.99 4.78 4.078 6.48 6.143 3.277 3.982 4.307 7.519 2.899 9.956-1.055 1.83-3.338 2.78-6.567 2.78-1.067 0-2.238-.103-3.504-.315-.328-.054-.661-.115-.997-.182.201-.696.388-1.424.557-2.178.273.055.542.103.808.148 3.98.66 6.881.147 7.76-1.376 1.068-1.85-.6-5.449-4.522-9.428-.391.357-.794.713-1.21 1.066-.062.051-.126.106-.187.154-1.11.93-2.302 1.842-3.561 2.728-.06.704-.13 1.4-.213 2.075-1.225 9.863-4.829 16.632-9.328 16.632-3.097 0-5.771-3.213-7.535-8.436.709-.193 1.434-.417 2.175-.667 1.465 4.319 3.469 6.858 5.36 6.858 2.136 0 4.42-3.243 5.907-8.631-.583-.186-1.17-.383-1.764-.603-1.355-.494-2.738-1.07-4.13-1.716l-.09.042c-.785.366-1.558.706-2.321 1.02-.119.048-.234.096-.35.138-4.392 1.77-8.404 2.687-11.594 2.687-3.177 0-5.534-.911-6.624-2.796-1.559-2.7-.084-6.654 3.607-10.822l1.568 1.654c-2.985 3.419-4.172 6.413-3.23 8.045 1.067 1.849 5.006 2.206 10.402.805-.127-.595-.248-1.202-.355-1.83-.244-1.41-.433-2.898-.569-4.45-.703-.491-1.387-.988-2.035-1.486C3.752 23.42 0 18.312 0 14.51c0-.879.202-1.687.616-2.405C2.168 9.42 6.288 8.712 11.697 9.796c-.205.705-.394 1.442-.564 2.206-4.448-.879-7.632-.408-8.571 1.224-1.067 1.848.594 5.44 4.504 9.413.502-.455 1.022-.907 1.569-1.355 1.053-.871 2.194-1.736 3.407-2.586.061-.706.13-1.403.216-2.08C13.483 6.767 17.087 0 21.582 0zm7.103 31.336c-.54.342-1.087.68-1.645 1.01-.19.113-.379.222-.568.33-.664.382-1.327.75-1.985 1.097-.097.052-.194.1-.29.152.681.288 1.358.558 2.028.807.605.225 1.202.431 1.794.625.132-.615.254-1.248.364-1.904.115-.681.212-1.393.302-2.117zm-14.212-.003c.094.76.203 1.5.325 2.212.105.624.224 1.224.35 1.81.363-.118.73-.24 1.102-.373.112-.039.228-.08.34-.122.766-.276 1.552-.58 2.353-.923l.023-.01c-.759-.397-1.518-.814-2.273-1.25-.039-.023-.08-.045-.12-.071-.72-.418-1.418-.844-2.1-1.273zm7.11-15.65c-.767.373-1.537.765-2.306 1.183-.487.263-.975.535-1.462.817-1.277.738-2.48 1.495-3.615 2.261-.046.654-.086 1.316-.111 1.997-.029.741-.042 1.498-.042 2.267 0 1.476.054 2.897.151 4.263.655.443 1.329.882 2.033 1.313.516.321 1.042.638 1.584.95 1.254.724 2.515 1.39 3.77 2 .08-.04.16-.075.241-.115.834-.41 1.677-.853 2.533-1.328.33-.18.66-.365.99-.558 1.278-.736 2.481-1.493 3.615-2.26.047-.654.087-1.317.112-1.998.029-.74.041-1.497.041-2.267 0-1.475-.054-2.895-.15-4.262-.653-.44-1.326-.88-2.03-1.314-.516-.32-1.045-.634-1.587-.949-1.277-.737-2.535-1.4-3.767-2zm0 5.64c1.593 0 2.885 1.292 2.885 2.885 0 1.594-1.292 2.886-2.886 2.886-1.593 0-2.885-1.292-2.885-2.886 0-1.593 1.292-2.885 2.885-2.885zm9.729.3c.033.847.05 1.71.05 2.585 0 .212 0 .424-.003.635-.007.663-.027 1.315-.052 1.96.578-.436 1.132-.874 1.661-1.312.068-.055.132-.106.196-.16.449-.376.878-.75 1.29-1.123-.378-.34-.77-.683-1.178-1.026-.619-.522-1.278-1.042-1.964-1.56zm-19.454-.006c-.52.392-1.021.785-1.501 1.177-.579.47-1.127.943-1.649 1.416.379.341.771.684 1.18 1.028.62.52 1.279 1.039 1.966 1.557-.034-.847-.051-1.71-.051-2.587 0-.211 0-.423.006-.631.005-.662.024-1.314.049-1.96zm16.158-8.556c-.3.097-.6.198-.903.303-.891.308-1.795.658-2.712 1.042l-.195.084c.75.396 1.507.812 2.266 1.25.039.023.08.045.119.07.717.414 1.414.842 2.1 1.277-.093-.762-.202-1.502-.324-2.216-.107-.623-.226-1.224-.351-1.81zm-12.87 0c-.13.613-.251 1.246-.361 1.9-.117.682-.215 1.391-.305 2.115.684-.432 1.387-.859 2.11-1.278l.103-.058c.757-.437 1.517-.853 2.276-1.25-.688-.29-1.364-.56-2.026-.805-.613-.23-1.21-.435-1.796-.624z' transform='translate(-432 -207) translate(432 207)'/%3E%3C/g%3E%3C/g%3E%3C/g%3E%3C/g%3E%3C/svg%3E%0A\");    background-repeat: no-repeat;\n    background-position: 50%;\n    background-repeat: no-repeat;\n    margin-bottom: 20px;\n}\n\n.%prefix%-logo.loading {\n    border-radius: 100%;\n    background-color: #3650A2;\n    background-image: url(\"data:image/svg+xml,%3Csvg viewBox='0.5 0.5 45 45' xmlns='http://www.w3.org/2000/svg' stroke='%23fff'%3E%3Cg fill='none' fill-rule='evenodd' transform='translate(1 1)' stroke-width='2'%3E%3Ccircle cx='22' cy='22' r='6' stroke-opacity='0'%3E%3Canimate attributeName='r' begin='1.5s' dur='3s' values='6;22' calcMode='linear' repeatCount='indefinite' /%3E%3Canimate attributeName='stroke-opacity' begin='1.5s' dur='3s' values='1;0' calcMode='linear' repeatCount='indefinite' /%3E%3Canimate attributeName='stroke-width' begin='1.5s' dur='3s' values='2;0' calcMode='linear' repeatCount='indefinite' /%3E%3C/circle%3E%3Ccircle cx='22' cy='22' r='6' stroke-opacity='0'%3E%3Canimate attributeName='r' begin='3s' dur='3s' values='6;22' calcMode='linear' repeatCount='indefinite' /%3E%3Canimate attributeName='stroke-opacity' begin='3s' dur='3s' values='1;0' calcMode='linear' repeatCount='indefinite' /%3E%3Canimate attributeName='stroke-width' begin='3s' dur='3s' values='2;0' calcMode='linear' repeatCount='indefinite' /%3E%3C/circle%3E%3Ccircle cx='22' cy='22' r='8'%3E%3Canimate attributeName='r' begin='0s' dur='1.5s' values='6;1;2;3;4;5;6' calcMode='linear' repeatCount='indefinite' /%3E%3C/circle%3E%3C/g%3E%3C/svg%3E\");\n}\n\n.%prefix%-logo.error {\n    background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 70 70'%3E%3Cdefs/%3E%3Ccircle cx='35' cy='35' r='35' fill='%23FC3D39'/%3E%3Cpath fill='%23fff' d='M22.3 48h25.4c2.5 0 4-1.7 4-4a4 4 0 00-.5-2L38.5 19.3a4 4 0 00-3.5-2 4 4 0 00-3.5 2L18.8 42.1c-.3.6-.5 1.3-.5 2 0 2.2 1.6 4 4 4zM35 37c-.9 0-1.4-.6-1.4-1.5l-.2-7.7c0-.9.6-1.6 1.6-1.6s1.7.7 1.7 1.6l-.3 7.7c0 1-.5 1.5-1.4 1.5zm0 6c-1 0-1.9-.8-1.9-1.8s.9-1.8 2-1.8c1 0 1.8.7 1.8 1.8 0 1-.9 1.8-1.9 1.8z'/%3E%3C/svg%3E\");\n}\n\n.%prefix%-logo.success {\n    background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 70 70'%3E%3Cdefs/%3E%3Ccircle cx='35' cy='35' r='35' fill='%233DC55D'/%3E%3Cpath fill='%23fff' d='M30.9 49.7a2 2 0 001.8-1L48 24.9c.3-.5.4-1 .4-1.4 0-1-.7-1.7-1.7-1.7-.8 0-1.2.3-1.6 1L30.8 45.4 23.5 36c-.5-.6-1-.9-1.6-.9-1 0-1.8.8-1.8 1.8 0 .4.2.9.6 1.3L29 48.7c.6.7 1.1 1 1.9 1z'/%3E%3C/svg%3E\");\n}\n\n.%prefix%-request {\n    padding: 20px 55px 40px 55px;\n    border-radius: 20px;\n    border-top-left-radius: 0;\n    border-top-right-radius: 0;\n}\n\n.%prefix%-separator {\n    margin-top: 20px;\n    width: 100%;\n    font-size: 12px;\n    display: flex;\n    align-items: center;\n    text-align: center;\n    color: white;\n}\n\n.%prefix%-separator::before,\n.%prefix%-separator::after {\n    content: '';\n    flex: 1;\n    opacity: 0.2;\n    border-bottom: 1px solid #d8d8d8;\n}\n\n.%prefix%-separator::before {\n    margin-right: .5em;\n}\n\n.%prefix%-separator::after {\n    margin-left: .5em;\n}\n\n.%prefix%-actions {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    position: relative;\n}\n\n.%prefix%-uri {\n    width: 100%;\n    padding: 20px 4px 0px 4px;\n}\n\n.%prefix%-background {\n    width: 250px;\n    height: 250px;\n    border-radius: 10px;\n    box-shadow: 0 4px 8px -2px rgba(141, 141, 148, 0.28), 0 0 2px 0 rgba(141, 141, 148, 0.16);\n    background-color: #ffffff;\n    position: relative;\n    z-index: 10;\n}\n\n.%prefix%-qr {\n    width: 210px;\n    position: absolute;\n    z-index: 5;\n    top: 20px;\n    left: 20px;\n}\n\n.%prefix%-qr svg {\n    width: 100%;\n    fill: #010c2c;\n}\n\n.%prefix%-footnote {\n    font-family: CircularStd-Book;\n    font-size: 16px;\n    text-align: center;\n    width: 100%;\n    position: absolute;\n    bottom: -30px;\n    left: 0;\n    color: white;\n}\n\n.%prefix%-footnote a {\n    color: white;\n}\n\n.%prefix%-wskeepalive {\n    display: none;\n}\n\n.%prefix%-uri a {\n    width: 100%;\n    background-color: rgba(255, 255, 255, 0.3);\n    font-family: CircularStd;\n    font-size: 16px;\n    font-weight: 500;\n    text-align: center;\n    color: #ffffff;\n    text-decoration: none;\n    flex-grow: 1;\n    flex: 1;\n    padding: 18px 0px 16px 0px;\n    display: block;\n}\n\n.%prefix%-uri a:hover {\n    background-color: rgba(255, 255, 255, 0.25);\n    transition: 0.2s ease;\n}\n`\n","import {LinkSession, LinkStorage, LinkTransport} from '@protonprotocol/proton-link'\nimport {SigningRequest} from '@protonprotocol/proton-signing-request'\nimport * as qrcode from 'qrcode'\nimport styleText from './styles'\n\nexport interface BrowserTransportOptions {\n    /** CSS class prefix, defaults to `@protonprotocol/proton-link` */\n    classPrefix?: string\n    /** Whether to inject CSS styles in the page header, defaults to true. */\n    injectStyles?: boolean\n    /** Whether to display request success and error messages, defaults to true */\n    requestStatus?: boolean\n    /** Local storage prefix, defaults to `@protonprotocol/proton-link`. */\n    storagePrefix?: string\n    /** Requesting account of the dapp (optional) */\n    requestAccount?: string\n}\n\nclass Storage implements LinkStorage {\n    constructor(readonly keyPrefix: string) {}\n    async write(key: string, data: string): Promise<void> {\n        localStorage.setItem(this.storageKey(key), data)\n    }\n    async read(key: string): Promise<string | null> {\n        return localStorage.getItem(this.storageKey(key))\n    }\n    async remove(key: string): Promise<void> {\n        localStorage.removeItem(this.storageKey(key))\n    }\n    storageKey(key: string) {\n        return `${this.keyPrefix}-${key}`\n    }\n}\n\nexport default class BrowserTransport implements LinkTransport {\n    storage: LinkStorage\n\n    constructor(public readonly options: BrowserTransportOptions = {}) {\n        this.classPrefix = options.classPrefix || 'proton-link'\n        this.injectStyles = !(options.injectStyles === false)\n        this.requestStatus = !(options.requestStatus === false)\n        this.storage = new Storage(options.storagePrefix || 'proton-link')\n        this.requestAccount = options.requestAccount || ''\n    }\n\n    private classPrefix: string\n    private injectStyles: boolean\n    private requestStatus: boolean\n    private requestAccount: string\n    private activeRequest?: SigningRequest\n    private activeCancel?: (reason: string | Error) => void\n    private containerEl!: HTMLElement\n    private requestEl!: HTMLElement\n    private styleEl?: HTMLStyleElement\n    private countdownTimer?: NodeJS.Timeout\n    private closeTimer?: NodeJS.Timeout\n\n    private closeModal() {\n        this.hide()\n        if (this.activeCancel) {\n            this.activeRequest = undefined\n            this.activeCancel('Modal closed')\n            this.activeCancel = undefined\n        }\n    }\n\n    private setupElements() {\n        if (this.injectStyles && !this.styleEl) {\n            this.styleEl = document.createElement('style')\n            this.styleEl.type = 'text/css'\n            const css = styleText.replace(/%prefix%/g, this.classPrefix)\n            this.styleEl.appendChild(document.createTextNode(css))\n            document.head.appendChild(this.styleEl)\n        }\n        if (!this.containerEl) {\n            this.containerEl = this.createEl()\n            this.containerEl.className = this.classPrefix\n            this.containerEl.onclick = (event) => {\n                if (event.target === this.containerEl) {\n                    event.stopPropagation()\n                    this.closeModal()\n                }\n            }\n            document.body.appendChild(this.containerEl)\n        }\n        if (!this.requestEl) {\n            const wrapper = this.createEl({class: 'inner'})\n            const nav = this.createEl({class: 'nav'})\n            const backButton = this.createEl({class: 'back'})\n            const navHeader = this.createEl({ class: 'header', tag: 'span', text: 'Scan the QR-code'})\n            const closeButton = this.createEl({class: 'close'})\n            closeButton.onclick = (event) => {\n                event.stopPropagation()\n                this.closeModal()\n            }\n            this.requestEl = this.createEl({class: 'request'})\n            nav.appendChild(backButton)\n            nav.appendChild(navHeader)\n            nav.appendChild(closeButton)\n            wrapper.appendChild(nav)\n            wrapper.appendChild(this.requestEl)\n            this.containerEl.appendChild(wrapper)\n        }\n    }\n\n    private createEl(attrs?: {[key: string]: string}) {\n        if (!attrs) attrs = {}\n        const el = document.createElement(attrs.tag || 'div')\n        if (attrs) {\n            for (const attr of Object.keys(attrs)) {\n                const value = attrs[attr]\n                switch (attr) {\n                    case 'src':\n                        el.setAttribute(attr, value)\n                        break\n                    case 'tag':\n                        break\n                    case 'text':\n                        el.appendChild(document.createTextNode(value))\n                        break\n                    case 'class':\n                        el.className = `${this.classPrefix}-${value}`\n                        break\n                    default:\n                        el.setAttribute(attr, value)\n                }\n            }\n        }\n        return el\n    }\n\n    private hide() {\n        if (this.containerEl) {\n            this.containerEl.classList.remove(`${this.classPrefix}-active`)\n        }\n        this.clearTimers()\n    }\n\n    private show() {\n        if (this.containerEl) {\n            this.containerEl.classList.add(`${this.classPrefix}-active`)\n        }\n    }\n\n    private async displayRequest(request) {\n        this.setupElements()\n\n        let sameDeviceRequest = request.clone()\n        sameDeviceRequest.setInfoKey('same_device', true)\n        sameDeviceRequest.setInfoKey('return_path', returnUrl())\n\n        if (this.requestAccount.length > 0) {\n            request.setInfoKey('req_account', this.requestAccount)\n            sameDeviceRequest.setInfoKey('req_account', this.requestAccount)\n        }\n\n        let sameDeviceUri = sameDeviceRequest.encode(true, false)\n        let crossDeviceUri = request.encode(true, false)\n\n        const logoEl = this.createEl({class: 'logo'})\n\n        const qrEl = this.createEl({class: 'qr'})\n        try {\n            qrEl.innerHTML = await qrcode.toString(crossDeviceUri, {\n                margin: 0,\n                errorCorrectionLevel: 'L',\n            })\n        } catch (error) {\n            console.warn('Unable to generate QR code', error)\n        }\n\n        const linkEl = this.createEl({class: 'uri'})\n        const linkA = this.createEl({\n            tag: 'a',\n            href: crossDeviceUri,\n            text: 'Open Proton Wallet',\n        })\n        linkA.addEventListener('click', (event) => {\n            event.preventDefault()\n            if (navigator.userAgent.toLowerCase().indexOf('firefox') > -1) {\n                iframe.setAttribute('src', sameDeviceUri)\n            } else {\n                window.location.href = sameDeviceUri\n            }\n        })\n        linkEl.appendChild(linkA)\n\n        const iframe = this.createEl({\n            class: 'wskeepalive',\n            src: 'about:blank',\n            tag: 'iframe',\n        })\n        linkEl.appendChild(iframe)\n\n\n        const backgroundEl = this.createEl({class: 'background'})\n        const divider = this.createEl({class: 'separator', text: 'OR'})\n\n        const actionEl = this.createEl({class: 'actions'})\n        actionEl.appendChild(backgroundEl)\n        actionEl.appendChild(divider)\n        actionEl.appendChild(linkEl)\n\n        backgroundEl.appendChild(qrEl)\n\n        let footnoteEl: HTMLElement = this.createEl({class: 'footnote'})\n        const isIdentity = request.isIdentity();\n        if (isIdentity) {\n            footnoteEl = this.createEl({class: 'footnote', text: \"Don't have Proton Wallet? \"})\n            const footnoteLink = this.createEl({\n                tag: 'a',\n                target: '_blank',\n                href: 'https://protonchain.com',\n                text: 'Download it here',\n            })\n            footnoteEl.appendChild(footnoteLink)\n        }\n\n        emptyElement(this.requestEl)\n\n        this.requestEl.appendChild(logoEl)\n        this.requestEl.appendChild(actionEl)\n        this.requestEl.appendChild(footnoteEl)\n\n        this.show()\n    }\n\n    public async showLoading() {\n        this.setupElements()\n        emptyElement(this.requestEl)\n        const infoEl = this.createEl({class: 'info'})\n        const infoTitle = this.createEl({class: 'title', tag: 'span', text: 'Loading'})\n        const infoSubtitle = this.createEl({\n            class: 'subtitle',\n            tag: 'span',\n            text: 'Preparing request...',\n        })\n\n        infoEl.appendChild(infoTitle)\n        infoEl.appendChild(infoSubtitle)\n\n        const logoEl = this.createEl({class: 'logo loading'})\n        this.requestEl.appendChild(logoEl)\n        this.requestEl.appendChild(infoEl)\n\n        this.show()\n    }\n\n    public onRequest(request: SigningRequest, cancel: (reason: string | Error) => void) {\n        this.activeRequest = request\n        this.activeCancel = cancel\n        this.displayRequest(request).catch(cancel)\n    }\n\n    public onSessionRequest(\n        session: LinkSession,\n        request: SigningRequest,\n        cancel: (reason: string | Error) => void\n    ) {\n        if (session.metadata.sameDevice) {\n            request.setInfoKey('return_path', returnUrl())\n        }\n\n        if (session.type === 'fallback') {\n            this.onRequest(request, cancel)\n            if (session.metadata.sameDevice) {\n                // trigger directly on a fallback same-device session\n                window.location.href = request.encode()\n            }\n            return\n        }\n\n        this.activeRequest = request\n        this.activeCancel = cancel\n        this.setupElements()\n\n        const timeout = session.metadata.timeout || 60 * 1000 * 2\n        const deviceName = session.metadata.name\n\n        const start = Date.now()\n        const infoTitle = this.createEl({class: 'title', tag: 'span', text: 'Sign'})\n\n        const updateCountdown = () => {\n            const timeLeft = timeout + start - Date.now()\n            const timeFormatted =\n                timeLeft > 0 ? new Date(timeLeft).toISOString().substr(14, 5) : '00:00'\n            infoTitle.textContent = `Sign - ${timeFormatted}`\n        }\n        this.countdownTimer = setInterval(updateCountdown, 500)\n        updateCountdown()\n\n        const infoEl = this.createEl({class: 'info'})\n        infoEl.appendChild(infoTitle)\n\n        let subtitle: string\n        if (deviceName && deviceName.length > 0) {\n            subtitle = `Please open on “${deviceName}” to review and sign the transaction.`\n        } else {\n            subtitle = 'Please review and sign the transaction in the linked wallet.'\n        }\n\n        const infoSubtitle = this.createEl({class: 'subtitle', tag: 'span', text: subtitle})\n        infoEl.appendChild(infoSubtitle)\n\n        emptyElement(this.requestEl)\n        const logoEl = this.createEl({class: 'logo'})\n        this.requestEl.appendChild(logoEl)\n        this.requestEl.appendChild(infoEl)\n        this.show()\n\n        if (isAppleHandheld() && session.metadata.sameDevice) {\n            const scheme = request.getScheme()\n            window.location.href = `${scheme}://link`\n        }\n    }\n\n    private clearTimers() {\n        if (this.closeTimer) {\n            clearTimeout(this.closeTimer)\n            this.closeTimer = undefined\n        }\n        if (this.countdownTimer) {\n            clearTimeout(this.countdownTimer)\n            this.countdownTimer = undefined\n        }\n    }\n\n    // private updatePrepareStatus(message: string): void {\n    //     if (this.prepareStatusEl) {\n    //         this.prepareStatusEl.textContent = message\n    //     }\n    // }\n\n    // public async prepare(request: SigningRequest, session?: LinkSession) {\n    //     this.showLoading()\n    //     if (!this.fuelEnabled || !session || request.isIdentity()) {\n    //         // don't attempt to cosign id request or if we don't have a session attached\n    //         return request\n    //     }\n    //     try {\n    //         const result = fuel(request, session, this.updatePrepareStatus.bind(this))\n    //         const timeout = new Promise((r) => setTimeout(r, 3500)).then(() => {\n    //             throw new Error('Fuel API timeout after 3500ms')\n    //         })\n    //         return await Promise.race([result, timeout])\n    //     } catch (error) {\n    //         console.info(`Not applying fuel (${error.message})`)\n    //     }\n    //     return request\n    // }\n\n    public onSuccess(request: SigningRequest) {\n        if (request === this.activeRequest) {\n            this.clearTimers()\n            if (this.requestStatus) {\n                this.setupElements()\n                const infoEl = this.createEl({class: 'info'})\n                const logoEl = this.createEl({class: 'logo'})\n                logoEl.classList.add('success')\n                const infoTitle = this.createEl({class: 'title', tag: 'span', text: 'Success!'})\n                const subtitle = request.isIdentity() ? 'Identity signed.' : 'Transaction signed.'\n                const infoSubtitle = this.createEl({class: 'subtitle', tag: 'span', text: subtitle})\n                infoEl.appendChild(infoTitle)\n                infoEl.appendChild(infoSubtitle)\n                emptyElement(this.requestEl)\n                this.requestEl.appendChild(logoEl)\n                this.requestEl.appendChild(infoEl)\n                this.show()\n                this.closeTimer = setTimeout(() => {\n                    this.hide()\n                }, 1.5 * 1000)\n            } else {\n                this.hide()\n            }\n        }\n    }\n\n    public onFailure(request: SigningRequest, error: Error) {\n        if (request === this.activeRequest && error['code'] !== 'E_CANCEL') {\n            this.clearTimers()\n            if (this.requestStatus) {\n                this.setupElements()\n                const infoEl = this.createEl({class: 'info'})\n                const logoEl = this.createEl({class: 'logo'})\n                logoEl.classList.add('error')\n                const infoTitle = this.createEl({\n                    class: 'title',\n                    tag: 'span',\n                    text: 'Transaction error',\n                })\n                const infoSubtitle = this.createEl({\n                    class: 'subtitle',\n                    tag: 'span',\n                    text: error.message || String(error),\n                })\n                infoEl.appendChild(infoTitle)\n                infoEl.appendChild(infoSubtitle)\n                emptyElement(this.requestEl)\n                this.requestEl.appendChild(logoEl)\n                this.requestEl.appendChild(infoEl)\n                this.show()\n            } else {\n                this.hide()\n            }\n        }\n    }\n}\n\nfunction emptyElement(el: HTMLElement) {\n    while (el.firstChild) {\n        el.removeChild(el.firstChild)\n    }\n}\n\nconst returnUrlAlphabet = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789'\nconst returnUrlAlphabetLen = returnUrlAlphabet.length\n/** Generate a return url with a random #fragment so mobile safari will redirect back w/o reload. */\nfunction returnUrl() {\n    let rv = window.location.href.split('#')[0] + '#'\n    for (let i = 0; i < 8; i++) {\n        rv += returnUrlAlphabet.charAt(Math.floor(Math.random() * returnUrlAlphabetLen))\n    }\n    return rv\n}\n\nfunction isAppleHandheld() {\n    return /iP(ad|od|hone)/i.test(navigator.userAgent)\n}\n"],"names":["qrcode.toString"],"mappings":"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"}